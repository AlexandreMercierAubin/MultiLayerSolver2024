 /* mexGrinspunBending.c - computes the grinspun bending energy
 *
 * [C, gradient, psi] = mexGrinspunBending( F, V, mu, lambda );
 *
 * Input:
 *  C        #9*triangles x 9*triangles full hessian matrix to add the bending hessian to
 *  grad     9*#triangles gradient matrix to add the bending gradient to
 *  p        3 x N verticies positions
 *  edge     #edges x 2 vertex ids of the edges
 *  opposite #edges x 2 opposite vertices of the edges the second value is 0 if it is a boundary
 *  kdXrestLengthdivHeightAverages       #edges x 1 : stiffness times rest length divided by edges half rest height width
 *  restAngle #edges angles of the shell at rest
 * 
 * Output:
 *  newC        9x#E x 9x#E energy hessian
 *  newGrad     9x#E by 1 energy gradient
 *  psi         scalar
 *
 * To compile type: mex -R2018a mexGrinspunBendingGradHess.cpp
 *
 * Notes:
 *
 * Code generated by energy/codeGenGrinpsunBending.m
 *========================================================*/
#define _USE_MATH_DEFINES
#include "mex.h"
#include "blas.h"
#include <math.h> 
#include <cmath> 
/* 
 * The gateway function
 */
double dot (double V11,double V12,double V13,double V21, double V22, double V23){
    return V11*V21 + V12*V22 + V13*V23;
}

void cross(double V11,double V12,double V13,double V21, double V22, double V23, double &O1, double &O2, double &O3){
	O1=(V12*V23 - V22*V13);
	O2=(V13*V21 - V23*V11);
	O3=(V11*V22 - V21*V12);
}

double norm(double V11,double V12,double V13){
   double dotprod = dot(V11,V12,V13,V11,V12,V13);
   return sqrt(dotprod);
}

int checkAngleDirection(double V11,double V12,double V13,double V21,double V22,double V23,double O11,double O12,double O13,double O21,double O22,double O23){
    double B11 = O11 - V11;
    double B12 = O12 - V12;
    double B13 = O13 - V13;

    double B21 = V21 - V11;
    double B22 = V22 - V12;
    double B23 = V23 - V13;

    double B31 = O21 - V11;
    double B32 = O22 - V12;
    double B33 = O23 - V13;

        
    double N11,N12,N13,N21,N22,N23, check1,check2,check3;

    cross(B11, B12, B13, B21, B22, B23, N11, N12, N13);
    cross(B21, B22, B23, B31, B32, B33, N21, N22, N23);

    double norm1 = norm(N11, N12, N13);
    double norm2 = norm(N21, N22, N23);
    N11 /= norm1;
    N12 /= norm1;
    N13 /= norm1;
    N21 /= norm2;
    N22 /= norm2;
    N23 /= norm2;

    cross(N11,N12,N13,N21,N22,N23,check1,check2,check3);
    double parallel = check1+check2+check3;
    double epsilon = 0.0000001;
    if(parallel<epsilon){
        return 1;
    }

    double dotNormals = dot(N11,N12,N13,N21,N22,N23);
    if(dotNormals<0){
        return 2;
    }
    return 0;
}

void mexFunction( int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[] ) {
    // check for proper number of arguments
    if ( nrhs != 5 ) {
        mexErrMsgIdAndTxt("ARP:mexComputeBendingEnergyGrinspun:nrhs","5 inputs required.");
    }
    if ( nlhs != 6 ) {
        mexErrMsgIdAndTxt("ARP:mexComputeBendingEnergyGrinspun:nlhs","6 outputs required.");
    }
     
    double *p = mxGetDoubles(prhs[0]);
    size_t ndofs = mxGetM(prhs[0]);
    size_t numEdges = mxGetM(prhs[1]);
    double *edge = mxGetDoubles(prhs[1]);
    double *opposite = mxGetDoubles(prhs[2]);
    double *kdXrestLengthdivHeightAverages = mxGetDoubles(prhs[3]);
    double *restAngle = mxGetDoubles(prhs[4]);
    
    //outputs
    plhs[0] = mxCreateDoubleMatrix( 12*12*numEdges, 1, mxREAL );
    double *ii = mxGetDoubles(plhs[0]);
    plhs[1] = mxCreateDoubleMatrix( 12*12*numEdges, 1, mxREAL );
    double *jj = mxGetDoubles(plhs[1]);
    plhs[2] = mxCreateDoubleMatrix( 12*12*numEdges, 1, mxREAL );
    double *newC = mxGetDoubles(plhs[2]);
    plhs[3] = mxCreateDoubleMatrix( ndofs, 1, mxREAL );
    double *newGrad = mxGetDoubles(plhs[3]);
    plhs[4] = mxCreateDoubleMatrix( numEdges, 1, mxREAL );
    double *angle = mxGetDoubles(plhs[4]);
    plhs[5] = mxCreateDoubleMatrix( numEdges, 1, mxREAL );
    double *psi = mxGetDoubles(plhs[5]);
    int counter = 0;
    
    
    double CBlock[12][12];
    double gradblock[12];
    int vertIDS[4];

    for ( size_t i = 0; i < numEdges; i++ ) {
        // starts with e1,e2, o1,o2
        vertIDS[0] = (int)edge[i]-1;
        vertIDS[1] = (int)edge[i + numEdges]-1;
        vertIDS[2] = (int)opposite[i]-1;
        vertIDS[3] = (int)opposite[i + numEdges]-1;

        double kd = kdXrestLengthdivHeightAverages[i];
        double angleRest = restAngle[i];
        
        double vertices1 = p[vertIDS[0]*3];
        double vertices2 = p[vertIDS[0]*3+1];
        double vertices3 = p[vertIDS[0]*3+2];
        double vertices4 = p[vertIDS[1]*3];
        double vertices5 = p[vertIDS[1]*3+1];
        double vertices6 = p[vertIDS[1]*3+2];
        double vertices7 = p[vertIDS[2]*3];
        double vertices8 = p[vertIDS[2]*3+1];
        double vertices9 = p[vertIDS[2]*3+2];
        double vertices10 = p[vertIDS[3]*3];
        double vertices11 = p[vertIDS[3]*3+1];
        double vertices12 = p[vertIDS[3]*3+2];
        
        int resCheck = checkAngleDirection(vertices1,vertices2,vertices3,vertices4,vertices5,vertices6,vertices7,vertices8,vertices9,vertices10,vertices11,vertices12);
        if (resCheck == 2){ 
           //invert opposite if the angle would be greater than 180 (flip the normals)
           angleRest = 2*M_PI - angleRest;
           int tmp = vertIDS[2];
           vertIDS[2] = vertIDS[3];
           vertIDS[3] = tmp;
           //readjust verts
           vertices1 = p[vertIDS[0] * 3];
           vertices2 = p[vertIDS[0] * 3 + 1];
           vertices3 = p[vertIDS[0] * 3 + 2];
           vertices4 = p[vertIDS[1] * 3];
           vertices5 = p[vertIDS[1] * 3 + 1];
           vertices6 = p[vertIDS[1] * 3 + 2];
           vertices7 = p[vertIDS[2] * 3];
           vertices8 = p[vertIDS[2] * 3 + 1];
           vertices9 = p[vertIDS[2] * 3 + 2];
           vertices10 = p[vertIDS[3] * 3];
           vertices11 = p[vertIDS[3] * 3 + 1];
           vertices12 = p[vertIDS[3] * 3 + 2];
           
        } else if(resCheck == 1){
            //if the normals are perpendicular then angle should be exactly pi use the sin formulation instead ;)
        }

        double t2 = -3.141592653589793;
        double t3 = -vertices4;
        double t4 = -vertices5;
        double t5 = -vertices6;
        double t6 = -vertices7;
        double t7 = -vertices8;
        double t8 = -vertices9;
        double t9 = -vertices10;
        double t10 = -vertices11;
        double t11 = -vertices12;
        double t12 = t3+vertices1;
        double t13 = t4+vertices2;
        double t14 = t6+vertices1;
        double t15 = t5+vertices3;
        double t16 = t7+vertices2;
        double t17 = t9+vertices1;
        double t18 = t6+vertices4;
        double t19 = t8+vertices3;
        double t20 = t10+vertices2;
        double t21 = t7+vertices5;
        double t22 = t9+vertices4;
        double t23 = t11+vertices3;
        double t24 = t8+vertices6;
        double t25 = t10+vertices5;
        double t26 = t11+vertices6;
        double t27 = t12*t12;
        double t28 = t13*t13;
        double t29 = t14*t14;
        double t30 = t15*t15;
        double t31 = t16*t16;
        double t32 = t17*t17;
        double t33 = t18*t18;
        double t34 = t19*t19;
        double t35 = t20*t20;
        double t36 = t21*t21;
        double t37 = t22*t22;
        double t38 = t23*t23;
        double t39 = t24*t24;
        double t40 = t25*t25;
        double t41 = t26*t26;
        double t57 = t12*t14;
        double t58 = t12*t16;
        double t59 = t13*t14;
        double t60 = t12*t17;
        double t61 = t12*t18;
        double t62 = t12*t19;
        double t63 = t13*t16;
        double t64 = t14*t15;
        double t65 = t12*t20;
        double t66 = t12*t21;
        double t67 = t13*t17;
        double t68 = t13*t18;
        double t69 = t12*t22;
        double t70 = t13*t19;
        double t71 = t15*t16;
        double t72 = t12*t23;
        double t73 = t12*t24;
        double t74 = t13*t20;
        double t75 = t13*t21;
        double t76 = t15*t17;
        double t77 = t15*t18;
        double t78 = t12*t25;
        double t79 = t13*t22;
        double t80 = t14*t20;
        double t81 = t15*t19;
        double t82 = t16*t17;
        double t83 = t13*t23;
        double t84 = t13*t24;
        double t85 = t14*t22;
        double t86 = t15*t20;
        double t87 = t15*t21;
        double t88 = t17*t18;
        double t89 = t12*t26;
        double t90 = t13*t25;
        double t91 = t14*t23;
        double t92 = t15*t22;
        double t93 = t17*t19;
        double t94 = t14*t25;
        double t95 = t15*t23;
        double t96 = t15*t24;
        double t97 = t16*t22;
        double t98 = t17*t21;
        double t99 = t18*t20;
        double t100 = t13*t26;
        double t101 = t15*t25;
        double t102 = t16*t23;
        double t103 = t19*t20;
        double t104 = t14*t26;
        double t105 = t16*t25;
        double t106 = t17*t24;
        double t107 = t18*t23;
        double t108 = t19*t22;
        double t109 = t20*t21;
        double t110 = t15*t26;
        double t111 = t18*t25;
        double t112 = t21*t22;
        double t113 = t16*t26;
        double t114 = t19*t25;
        double t115 = t20*t24;
        double t116 = t21*t23;
        double t117 = t18*t26;
        double t118 = t22*t24;
        double t119 = t19*t26;
        double t120 = t23*t24;
        double t121 = t21*t26;
        double t122 = t24*t25;
        double t141 = t14*t17*2.0;
        double t142 = t14*t18*2.0;
        double t155 = t14*t21*2.0;
        double t158 = t16*t18*2.0;
        double t167 = t14*t24*2.0;
        double t169 = t16*t20*2.0;
        double t170 = t16*t21*2.0;
        double t171 = t18*t19*2.0;
        double t178 = t16*t24*2.0;
        double t179 = t17*t22*2.0;
        double t180 = t18*t22*2.0;
        double t181 = t19*t21*2.0;
        double t183 = t17*t25*2.0;
        double t184 = t19*t23*2.0;
        double t185 = t19*t24*2.0;
        double t186 = t20*t22*2.0;
        double t187 = t17*t26*2.0;
        double t188 = t20*t25*2.0;
        double t189 = t21*t25*2.0;
        double t190 = t22*t23*2.0;
        double t191 = t20*t26*2.0;
        double t192 = t23*t25*2.0;
        double t193 = t23*t26*2.0;
        double t194 = t24*t26*2.0;
        double t42 = t27*2.0;
        double t43 = t28*2.0;
        double t44 = t29*2.0;
        double t45 = t30*2.0;
        double t46 = t31*2.0;
        double t47 = t32*2.0;
        double t48 = t33*2.0;
        double t49 = t34*2.0;
        double t50 = t35*2.0;
        double t51 = t36*2.0;
        double t52 = t37*2.0;
        double t53 = t38*2.0;
        double t54 = t39*2.0;
        double t55 = t40*2.0;
        double t56 = t41*2.0;
        double t123 = t57*2.0;
        double t124 = t58*2.0;
        double t125 = t59*2.0;
        double t126 = t60*2.0;
        double t127 = t61*2.0;
        double t128 = t58*4.0;
        double t129 = t62*2.0;
        double t130 = t59*4.0;
        double t131 = t63*2.0;
        double t132 = t64*2.0;
        double t133 = t65*2.0;
        double t134 = t66*2.0;
        double t135 = t67*2.0;
        double t136 = t68*2.0;
        double t137 = t62*4.0;
        double t138 = t69*2.0;
        double t139 = t70*2.0;
        double t140 = t64*4.0;
        double t143 = t71*2.0;
        double t144 = t65*4.0;
        double t145 = t72*2.0;
        double t146 = t73*2.0;
        double t147 = t67*4.0;
        double t148 = t74*2.0;
        double t149 = t75*2.0;
        double t150 = t76*2.0;
        double t151 = t77*2.0;
        double t152 = t78*2.0;
        double t153 = t70*4.0;
        double t154 = t79*2.0;
        double t156 = t71*4.0;
        double t157 = t81*2.0;
        double t159 = t72*4.0;
        double t160 = t83*2.0;
        double t161 = t84*2.0;
        double t162 = t76*4.0;
        double t163 = t86*2.0;
        double t164 = t87*2.0;
        double t165 = t89*2.0;
        double t166 = t90*2.0;
        double t168 = t92*2.0;
        double t172 = t83*4.0;
        double t173 = t86*4.0;
        double t174 = t95*2.0;
        double t175 = t96*2.0;
        double t176 = t100*2.0;
        double t177 = t101*2.0;
        double t182 = t110*2.0;
        double t195 = -t58;
        double t196 = -t59;
        double t199 = -t62;
        double t200 = -t64;
        double t202 = -t65;
        double t204 = -t67;
        double t208 = -t70;
        double t209 = -t71;
        double t210 = -t72;
        double t214 = -t76;
        double t218 = -t83;
        double t220 = -t86;
        double t225 = t27+t28;
        double t226 = t27+t30;
        double t227 = t28+t30;
        double t231 = t57+t63;
        double t232 = t57+t81;
        double t233 = t60+t74;
        double t234 = t61+t75;
        double t235 = t63+t81;
        double t236 = t60+t95;
        double t237 = t61+t96;
        double t238 = t69+t90;
        double t239 = t80+t82;
        double t240 = t74+t95;
        double t241 = t75+t96;
        double t242 = t69+t110;
        double t243 = t91+t93;
        double t244 = t90+t110;
        double t245 = t102+t103;
        double t246 = t111+t112;
        double t247 = t117+t118;
        double t248 = t121+t122;
        double t269 = t142+t170;
        double t273 = t142+t185;
        double t275 = t170+t185;
        double t276 = t179+t188;
        double t277 = t179+t193;
        double t278 = t188+t193;
        double t423 = t85+t88+t105+t109;
        double t424 = t85+t88+t119+t120;
        double t425 = t105+t109+t119+t120;
        double t197 = -t124;
        double t198 = -t125;
        double t201 = -t129;
        double t203 = -t130;
        double t205 = -t132;
        double t206 = -t133;
        double t207 = -t135;
        double t211 = -t139;
        double t212 = -t140;
        double t213 = -t143;
        double t215 = -t145;
        double t216 = -t147;
        double t217 = -t150;
        double t219 = -t156;
        double t221 = -t160;
        double t222 = -t162;
        double t223 = -t163;
        double t224 = -t173;
        double t228 = t42+t43;
        double t229 = t42+t45;
        double t230 = t43+t45;
        double t249 = t58+t196;
        double t251 = t123+t131;
        double t252 = t62+t200;
        double t254 = t65+t204;
        double t256 = t123+t157;
        double t257 = t70+t209;
        double t259 = t126+t148;
        double t260 = t127+t149;
        double t261 = t72+t214;
        double t263 = t131+t157;
        double t264 = t126+t174;
        double t265 = t127+t175;
        double t266 = t83+t220;
        double t268 = t138+t166;
        double t270 = t148+t174;
        double t271 = t149+t175;
        double t272 = t138+t182;
        double t274 = t166+t182;
        double t279 = t124+t196;
        double t282 = t129+t200;
        double t283 = t133+t204;
        double t286 = t139+t209;
        double t289 = t145+t214;
        double t294 = t160+t220;
        double t388 = t59+t68+t195;
        double t390 = t64+t77+t199;
        double t392 = t67+t79+t202;
        double t394 = t71+t87+t208;
        double t396 = t76+t92+t210;
        double t398 = t86+t101+t218;
        double t454 = t59+t67+t97+t99+t195+t202;
        double t456 = t64+t76+t107+t108+t199+t210;
        double t458 = t71+t86+t114+t116+t208+t218;
        double t250 = t58+t198;
        double t253 = t62+t205;
        double t255 = t65+t207;
        double t258 = t70+t213;
        double t262 = t72+t217;
        double t267 = t83+t223;
        double t280 = t124+t203;
        double t281 = t128+t198;
        double t284 = t129+t212;
        double t285 = t137+t205;
        double t287 = t133+t216;
        double t288 = t144+t207;
        double t290 = t139+t219;
        double t291 = t153+t213;
        double t292 = t145+t222;
        double t293 = t159+t217;
        double t295 = t160+t224;
        double t296 = t172+t223;
        double t297 = t249*t249;
        double t298 = t252*t252;
        double t299 = t254*t254;
        double t300 = t257*t257;
        double t301 = t261*t261;
        double t302 = t266*t266;
        double t303 = t12*t249;
        double t304 = t13*t249;
        double t305 = t12*t252;
        double t306 = t12*t254;
        double t307 = t17*t249;
        double t308 = t13*t254;
        double t309 = t15*t252;
        double t310 = t20*t249;
        double t311 = t14*t254;
        double t312 = t22*t249;
        double t313 = t12*t261;
        double t314 = t13*t257;
        double t315 = t17*t252;
        double t316 = t16*t254;
        double t317 = t25*t249;
        double t318 = t15*t257;
        double t319 = t18*t254;
        double t320 = t14*t261;
        double t321 = t22*t252;
        double t322 = t15*t261;
        double t323 = t21*t254;
        double t324 = t23*t252;
        double t325 = t13*t266;
        double t326 = t18*t261;
        double t327 = t20*t257;
        double t328 = t19*t261;
        double t329 = t26*t252;
        double t330 = t15*t266;
        double t331 = t23*t257;
        double t332 = t16*t266;
        double t333 = t25*t257;
        double t334 = t24*t261;
        double t335 = t19*t266;
        double t336 = t26*t257;
        double t337 = t21*t266;
        double t338 = t24*t266;
        double t341 = t14*t249*2.0;
        double t343 = t16*t249*2.0;
        double t345 = t18*t249*2.0;
        double t346 = t14*t252*2.0;
        double t349 = t21*t249*2.0;
        double t352 = t18*t252*2.0;
        double t353 = t19*t252*2.0;
        double t355 = t17*t254*2.0;
        double t356 = t16*t257*2.0;
        double t358 = t20*t254*2.0;
        double t359 = t24*t252*2.0;
        double t360 = t19*t257*2.0;
        double t361 = t22*t254*2.0;
        double t363 = t17*t261*2.0;
        double t364 = t21*t257*2.0;
        double t365 = t25*t254*2.0;
        double t367 = t24*t257*2.0;
        double t368 = t22*t261*2.0;
        double t369 = t23*t261*2.0;
        double t370 = t20*t266*2.0;
        double t371 = t26*t261*2.0;
        double t372 = t23*t266*2.0;
        double t373 = t25*t266*2.0;
        double t374 = t26*t266*2.0;
        double t387 = t66+t249;
        double t389 = t73+t252;
        double t391 = t78+t254;
        double t393 = t84+t257;
        double t395 = t89+t261;
        double t397 = t100+t266;
        double t399 = t125+t136+t197;
        double t400 = t124+t134+t198;
        double t401 = t125+t158+t197;
        double t402 = t124+t155+t198;
        double t403 = t132+t151+t201;
        double t404 = t129+t146+t205;
        double t405 = t132+t171+t201;
        double t406 = t129+t167+t205;
        double t407 = t135+t154+t206;
        double t408 = t133+t152+t207;
        double t409 = t143+t164+t211;
        double t410 = t139+t161+t213;
        double t411 = t135+t186+t206;
        double t412 = t133+t183+t207;
        double t413 = t143+t181+t211;
        double t414 = t139+t178+t213;
        double t415 = t150+t168+t215;
        double t416 = t145+t165+t217;
        double t417 = t150+t190+t215;
        double t418 = t145+t187+t217;
        double t419 = t163+t177+t221;
        double t420 = t160+t176+t223;
        double t421 = t163+t192+t221;
        double t422 = t160+t191+t223;
        double t426 = t249*t254;
        double t427 = t252*t261;
        double t428 = t257*t266;
        double t453 = t94+t98+t249+t254;
        double t455 = t104+t106+t252+t261;
        double t457 = t113+t115+t257+t266;
        double t339 = t303*2.0;
        double t340 = t304*2.0;
        double t342 = t305*2.0;
        double t344 = t306*2.0;
        double t347 = t308*2.0;
        double t348 = t309*2.0;
        double t350 = t313*2.0;
        double t351 = t314*2.0;
        double t354 = t318*2.0;
        double t357 = t322*2.0;
        double t362 = t325*2.0;
        double t366 = t330*2.0;
        double t375 = -t318;
        double t377 = -t360;
        double t378 = -t330;
        double t379 = -t331;
        double t381 = -t367;
        double t382 = -t335;
        double t383 = -t336;
        double t384 = -t338;
        double t385 = -t372;
        double t386 = -t374;
        double t429 = t304+t309;
        double t430 = t305+t314;
        double t431 = t308+t322;
        double t432 = t313+t325;
        double t436 = t343+t353;
        double t437 = t346+t356;
        double t440 = t349+t359;
        double t442 = t352+t364;
        double t443 = t358+t369;
        double t444 = t363+t370;
        double t445 = t365+t371;
        double t446 = t368+t373;
        double t459 = t297+t298+t300;
        double t460 = t299+t301+t302;
        double t471 = t310+t316+t324+t328;
        double t472 = t315+t320+t327+t332;
        double t473 = t317+t323+t329+t334;
        double t474 = t321+t326+t333+t337;
        double t477 = t426+t427+t428;
        double t376 = -t354;
        double t380 = -t366;
        double t433 = t303+t375;
        double t434 = t340+t348;
        double t435 = t342+t351;
        double t438 = t306+t378;
        double t439 = t347+t357;
        double t441 = t350+t362;
        double t448 = t341+t377;
        double t450 = t345+t381;
        double t451 = t355+t385;
        double t452 = t361+t386;
        double t461 = 1.0/t459;
        double t463 = 1.0/t460;
        double t465 = 1.0/sqrt(t459);
        double t468 = 1.0/sqrt(t460);
        double t475 = t307+t311+t379+t382;
        double t476 = t312+t319+t383+t384;
        double t478 = t477*t477;
        double t447 = t339+t376;
        double t449 = t344+t380;
        double t462 = t461*t461;
        double t464 = t463*t463;
        double t466 = t465*t465*t465;
        double t467 = t465*t465*t465*t465*t465;
        double t469 = t468*t468*t468;
        double t470 = t468*t468*t468*t468*t468;
        double t479 = t12*t13*t465*t468;
        double t480 = t12*t15*t465*t468;
        double t481 = t13*t15*t465*t468;
        double t484 = t225*t465*t468;
        double t485 = t226*t465*t468;
        double t486 = t227*t465*t468;
        double t487 = t231*t465*t468;
        double t488 = t232*t465*t468;
        double t489 = t233*t465*t468;
        double t490 = t234*t465*t468;
        double t491 = t235*t465*t468;
        double t492 = t236*t465*t468;
        double t493 = t237*t465*t468;
        double t494 = t238*t465*t468;
        double t495 = t239*t465*t468;
        double t496 = t240*t465*t468;
        double t497 = t241*t465*t468;
        double t498 = t242*t465*t468;
        double t499 = t243*t465*t468;
        double t500 = t244*t465*t468;
        double t501 = t245*t465*t468;
        double t502 = t246*t465*t468;
        double t503 = t247*t465*t468;
        double t504 = t248*t465*t468;
        double t506 = t250*t465*t468;
        double t508 = t253*t465*t468;
        double t511 = t255*t465*t468;
        double t513 = t258*t465*t468;
        double t516 = t262*t465*t468;
        double t521 = t267*t465*t468;
        double t529 = -t465*t468*(t59+t197);
        double t530 = -t465*t468*(t64+t201);
        double t531 = -t465*t468*(t67+t206);
        double t532 = -t465*t468*(t71+t211);
        double t533 = -t465*t468*(t76+t215);
        double t534 = -t465*t468*(t86+t221);
        double t537 = t465*t468*(t59+t197);
        double t538 = t465*t468*(t64+t201);
        double t539 = t465*t468*(t67+t206);
        double t540 = t465*t468*(t76+t215);
        double t541 = t387*t465*t468;
        double t542 = t388*t465*t468;
        double t543 = t389*t465*t468;
        double t544 = t390*t465*t468;
        double t545 = t391*t465*t468;
        double t546 = t392*t465*t468;
        double t547 = t393*t465*t468;
        double t548 = t394*t465*t468;
        double t549 = t395*t465*t468;
        double t550 = t396*t465*t468;
        double t551 = t397*t465*t468;
        double t552 = t398*t465*t468;
        double t561 = t423*t465*t468;
        double t562 = t424*t465*t468;
        double t563 = t425*t465*t468;
        double t567 = t429*t465*t468;
        double t568 = t430*t465*t468;
        double t569 = t431*t465*t468;
        double t570 = t432*t465*t468;
        double t571 = t433*t465*t468;
        double t572 = t438*t465*t468;
        double t573 = t453*t465*t468;
        double t574 = t454*t465*t468;
        double t575 = t455*t465*t468;
        double t576 = t456*t465*t468;
        double t577 = t457*t465*t468;
        double t578 = t458*t465*t468;
        double t585 = t465*t468*t471;
        double t586 = t465*t468*t472;
        double t587 = t465*t468*t473;
        double t588 = t465*t468*t474;
        double t593 = t465*t468*t475;
        double t594 = t465*t468*t476;
        double t705 = t461*t463*t478;
        double t706 = t465*t468*t477;
        double t911 = t429*t461*t463*t477*2.0;
        double t912 = t430*t461*t463*t477*2.0;
        double t913 = t431*t461*t463*t477*2.0;
        double t914 = t432*t461*t463*t477*2.0;
        double t915 = t433*t461*t463*t477*2.0;
        double t916 = t438*t461*t463*t477*2.0;
        double t965 = t461*t463*t471*t477*2.0;
        double t966 = t461*t463*t472*t477*2.0;
        double t967 = t461*t463*t473*t477*2.0;
        double t968 = t461*t463*t474*t477*2.0;
        double t973 = t461*t463*t475*t477*2.0;
        double t974 = t461*t463*t476*t477*2.0;
        double t482 = -t479;
        double t483 = -t480;
        double t505 = -t487;
        double t507 = -t488;
        double t509 = -t489;
        double t510 = -t490;
        double t512 = -t491;
        double t514 = -t492;
        double t515 = -t493;
        double t517 = -t494;
        double t518 = -t495;
        double t519 = -t496;
        double t520 = -t497;
        double t522 = -t498;
        double t523 = -t499;
        double t524 = -t500;
        double t525 = -t501;
        double t526 = -t502;
        double t527 = -t503;
        double t528 = -t504;
        double t535 = -t513;
        double t536 = -t521;
        double t553 = -t541;
        double t554 = -t542;
        double t555 = -t543;
        double t556 = -t544;
        double t557 = -t545;
        double t558 = -t546;
        double t559 = -t549;
        double t560 = -t550;
        double t564 = -t561;
        double t565 = -t562;
        double t566 = -t563;
        double t579 = -t573;
        double t580 = -t574;
        double t581 = -t575;
        double t582 = -t576;
        double t583 = -t577;
        double t584 = -t578;
        double t589 = -t585;
        double t590 = -t586;
        double t591 = -t587;
        double t592 = -t588;
        double t595 = (t429*t434*t466*t468)/2.0;
        double t596 = (t429*t435*t466*t468)/2.0;
        double t597 = (t430*t434*t466*t468)/2.0;
        double t598 = (t429*t436*t466*t468)/2.0;
        double t599 = (t430*t435*t466*t468)/2.0;
        double t600 = (t429*t437*t466*t468)/2.0;
        double t601 = (t430*t436*t466*t468)/2.0;
        double t602 = (t429*t440*t466*t468)/2.0;
        double t603 = (t430*t437*t466*t468)/2.0;
        double t604 = (t429*t441*t465*t469)/2.0;
        double t605 = (t429*t442*t466*t468)/2.0;
        double t606 = (t430*t439*t465*t469)/2.0;
        double t607 = (t430*t440*t466*t468)/2.0;
        double t608 = (t432*t434*t466*t468)/2.0;
        double t609 = (t431*t435*t466*t468)/2.0;
        double t610 = (t431*t436*t466*t468)/2.0;
        double t611 = (t430*t442*t466*t468)/2.0;
        double t612 = (t432*t436*t466*t468)/2.0;
        double t613 = (t431*t437*t466*t468)/2.0;
        double t614 = (t429*t443*t465*t469)/2.0;
        double t615 = (t431*t439*t465*t469)/2.0;
        double t616 = (t431*t440*t466*t468)/2.0;
        double t617 = (t432*t437*t466*t468)/2.0;
        double t618 = (t429*t444*t465*t469)/2.0;
        double t619 = (t430*t443*t465*t469)/2.0;
        double t620 = (t431*t441*t465*t469)/2.0;
        double t621 = (t431*t442*t466*t468)/2.0;
        double t622 = (t432*t439*t465*t469)/2.0;
        double t623 = (t432*t440*t466*t468)/2.0;
        double t624 = (t429*t445*t465*t469)/2.0;
        double t625 = (t430*t444*t465*t469)/2.0;
        double t626 = (t432*t441*t465*t469)/2.0;
        double t627 = (t432*t442*t466*t468)/2.0;
        double t628 = (t429*t446*t465*t469)/2.0;
        double t629 = (t430*t445*t465*t469)/2.0;
        double t630 = (t431*t443*t465*t469)/2.0;
        double t631 = (t430*t446*t465*t469)/2.0;
        double t632 = (t431*t444*t465*t469)/2.0;
        double t633 = (t432*t443*t465*t469)/2.0;
        double t634 = (t431*t445*t465*t469)/2.0;
        double t635 = (t432*t444*t465*t469)/2.0;
        double t636 = (t431*t446*t465*t469)/2.0;
        double t637 = (t432*t445*t465*t469)/2.0;
        double t638 = (t432*t446*t465*t469)/2.0;
        double t639 = -t593;
        double t640 = -t594;
        double t642 = (t429*t447*t466*t468)/2.0;
        double t643 = (t430*t447*t466*t468)/2.0;
        double t644 = (t429*t448*t466*t468)/2.0;
        double t646 = (t430*t448*t466*t468)/2.0;
        double t647 = (t429*t449*t465*t469)/2.0;
        double t648 = (t429*t450*t466*t468)/2.0;
        double t649 = (t431*t447*t466*t468)/2.0;
        double t650 = (t430*t449*t465*t469)/2.0;
        double t651 = (t430*t450*t466*t468)/2.0;
        double t652 = (t432*t447*t466*t468)/2.0;
        double t653 = (t431*t448*t466*t468)/2.0;
        double t655 = (t432*t448*t466*t468)/2.0;
        double t656 = (t429*t451*t465*t469)/2.0;
        double t657 = (t431*t449*t465*t469)/2.0;
        double t658 = (t431*t450*t466*t468)/2.0;
        double t659 = (t430*t451*t465*t469)/2.0;
        double t660 = (t432*t449*t465*t469)/2.0;
        double t661 = (t432*t450*t466*t468)/2.0;
        double t662 = (t429*t452*t465*t469)/2.0;
        double t664 = (t430*t452*t465*t469)/2.0;
        double t665 = (t431*t451*t465*t469)/2.0;
        double t666 = (t432*t451*t465*t469)/2.0;
        double t667 = (t431*t452*t465*t469)/2.0;
        double t668 = (t432*t452*t465*t469)/2.0;
        double t669 = (t433*t434*t466*t468)/2.0;
        double t670 = (t433*t435*t466*t468)/2.0;
        double t671 = (t433*t436*t466*t468)/2.0;
        double t672 = (t433*t437*t466*t468)/2.0;
        double t673 = (t433*t439*t465*t469)/2.0;
        double t674 = (t433*t440*t466*t468)/2.0;
        double t675 = (t434*t438*t466*t468)/2.0;
        double t676 = (t433*t441*t465*t469)/2.0;
        double t677 = (t433*t442*t466*t468)/2.0;
        double t678 = (t435*t438*t466*t468)/2.0;
        double t679 = (t436*t438*t466*t468)/2.0;
        double t680 = (t437*t438*t466*t468)/2.0;
        double t681 = (t433*t443*t465*t469)/2.0;
        double t682 = (t438*t439*t465*t469)/2.0;
        double t683 = (t438*t440*t466*t468)/2.0;
        double t684 = (t433*t444*t465*t469)/2.0;
        double t685 = (t438*t441*t465*t469)/2.0;
        double t686 = (t438*t442*t466*t468)/2.0;
        double t687 = (t433*t445*t465*t469)/2.0;
        double t688 = (t433*t446*t465*t469)/2.0;
        double t689 = (t438*t443*t465*t469)/2.0;
        double t690 = (t438*t444*t465*t469)/2.0;
        double t691 = (t438*t445*t465*t469)/2.0;
        double t692 = (t438*t446*t465*t469)/2.0;
        double t693 = (t433*t447*t466*t468)/2.0;
        double t694 = (t433*t448*t466*t468)/2.0;
        double t695 = (t433*t450*t466*t468)/2.0;
        double t696 = (t438*t448*t466*t468)/2.0;
        double t697 = (t433*t451*t465*t469)/2.0;
        double t698 = (t438*t449*t465*t469)/2.0;
        double t699 = (t438*t450*t466*t468)/2.0;
        double t700 = (t433*t452*t465*t469)/2.0;
        double t701 = (t438*t451*t465*t469)/2.0;
        double t702 = (t438*t452*t465*t469)/2.0;
        double t707 = -t705;
        double t708 = acos(t706);
        double t709 = t705-1.0;
        double t715 = t12*t13*t465*t469*t477;
        double t716 = t12*t13*t466*t468*t477;
        double t717 = t12*t15*t465*t469*t477;
        double t718 = t12*t15*t466*t468*t477;
        double t719 = t13*t15*t465*t469*t477;
        double t720 = t13*t15*t466*t468*t477;
        double t721 = t14*t16*t466*t468*t477;
        double t722 = t14*t19*t466*t468*t477;
        double t723 = t16*t19*t466*t468*t477;
        double t724 = t17*t20*t465*t469*t477;
        double t725 = t18*t21*t466*t468*t477;
        double t726 = t17*t23*t465*t469*t477;
        double t727 = t18*t24*t466*t468*t477;
        double t728 = t20*t23*t465*t469*t477;
        double t729 = t21*t24*t466*t468*t477;
        double t730 = t22*t25*t465*t469*t477;
        double t731 = t22*t26*t465*t469*t477;
        double t732 = t25*t26*t465*t469*t477;
        double t735 = (t251*t466*t468*t477)/2.0;
        double t736 = (t256*t466*t468*t477)/2.0;
        double t737 = (t259*t465*t469*t477)/2.0;
        double t738 = (t260*t466*t468*t477)/2.0;
        double t739 = (t263*t466*t468*t477)/2.0;
        double t740 = (t264*t465*t469*t477)/2.0;
        double t741 = (t265*t466*t468*t477)/2.0;
        double t742 = (t268*t465*t469*t477)/2.0;
        double t743 = (t269*t466*t468*t477)/2.0;
        double t744 = (t270*t465*t469*t477)/2.0;
        double t745 = (t271*t466*t468*t477)/2.0;
        double t746 = (t272*t465*t469*t477)/2.0;
        double t747 = (t273*t466*t468*t477)/2.0;
        double t748 = (t274*t465*t469*t477)/2.0;
        double t749 = (t275*t466*t468*t477)/2.0;
        double t750 = (t276*t465*t469*t477)/2.0;
        double t751 = (t277*t465*t469*t477)/2.0;
        double t752 = (t278*t465*t469*t477)/2.0;
        double t753 = (t280*t466*t468*t477)/2.0;
        double t754 = t466*t468*t477*(t125-t128)*(-1.0/2.0);
        double t755 = (t284*t466*t468*t477)/2.0;
        double t756 = t466*t468*t477*(t132-t137)*(-1.0/2.0);
        double t757 = (t287*t465*t469*t477)/2.0;
        double t758 = t465*t469*t477*(t135-t144)*(-1.0/2.0);
        double t759 = (t290*t466*t468*t477)/2.0;
        double t760 = t466*t468*t477*(t143-t153)*(-1.0/2.0);
        double t761 = (t292*t465*t469*t477)/2.0;
        double t762 = t465*t469*t477*(t150-t159)*(-1.0/2.0);
        double t763 = (t295*t465*t469*t477)/2.0;
        double t764 = t465*t469*t477*(t163-t172)*(-1.0/2.0);
        double t768 = (t466*t468*t477*(t143-t153))/2.0;
        double t770 = (t465*t469*t477*(t163-t172))/2.0;
        double t771 = (t434*t466*t468*t471)/2.0;
        double t772 = (t435*t466*t468*t471)/2.0;
        double t773 = (t434*t466*t468*t472)/2.0;
        double t774 = (t437*t466*t468*t471)/2.0;
        double t775 = (t434*t466*t468*t473)/2.0;
        double t776 = (t435*t466*t468*t472)/2.0;
        double t777 = (t439*t465*t469*t471)/2.0;
        double t778 = (t440*t466*t468*t471)/2.0;
        double t779 = (t436*t466*t468*t472)/2.0;
        double t780 = (t435*t466*t468*t473)/2.0;
        double t781 = (t441*t465*t469*t471)/2.0;
        double t782 = (t442*t466*t468*t471)/2.0;
        double t783 = (t436*t466*t468*t473)/2.0;
        double t784 = (t434*t466*t468*t474)/2.0;
        double t785 = (t439*t465*t469*t472)/2.0;
        double t786 = (t440*t466*t468*t472)/2.0;
        double t787 = (t437*t466*t468*t473)/2.0;
        double t788 = (t435*t466*t468*t474)/2.0;
        double t789 = (t439*t465*t469*t473)/2.0;
        double t790 = (t441*t465*t469*t472)/2.0;
        double t791 = (t442*t466*t468*t472)/2.0;
        double t792 = (t436*t466*t468*t474)/2.0;
        double t793 = (t441*t465*t469*t473)/2.0;
        double t794 = (t442*t466*t468*t473)/2.0;
        double t795 = (t444*t465*t469*t471)/2.0;
        double t796 = (t437*t466*t468*t474)/2.0;
        double t797 = (t445*t465*t469*t471)/2.0;
        double t798 = (t439*t465*t469*t474)/2.0;
        double t799 = (t440*t466*t468*t474)/2.0;
        double t800 = (t443*t465*t469*t472)/2.0;
        double t801 = (t446*t465*t469*t471)/2.0;
        double t802 = (t441*t465*t469*t474)/2.0;
        double t803 = (t443*t465*t469*t473)/2.0;
        double t804 = (t445*t465*t469*t472)/2.0;
        double t805 = (t444*t465*t469*t473)/2.0;
        double t806 = (t446*t465*t469*t472)/2.0;
        double t807 = (t443*t465*t469*t474)/2.0;
        double t808 = (t446*t465*t469*t473)/2.0;
        double t809 = (t444*t465*t469*t474)/2.0;
        double t810 = (t445*t465*t469*t474)/2.0;
        double t811 = (t447*t466*t468*t471)/2.0;
        double t812 = (t448*t466*t468*t471)/2.0;
        double t813 = (t447*t466*t468*t472)/2.0;
        double t814 = (t447*t466*t468*t473)/2.0;
        double t815 = (t449*t465*t469*t471)/2.0;
        double t816 = (t450*t466*t468*t471)/2.0;
        double t817 = (t448*t466*t468*t472)/2.0;
        double t818 = (t448*t466*t468*t473)/2.0;
        double t819 = (t447*t466*t468*t474)/2.0;
        double t820 = (t449*t465*t469*t472)/2.0;
        double t821 = (t450*t466*t468*t472)/2.0;
        double t822 = (t449*t465*t469*t473)/2.0;
        double t823 = (t450*t466*t468*t473)/2.0;
        double t824 = (t451*t465*t469*t471)/2.0;
        double t825 = (t448*t466*t468*t474)/2.0;
        double t826 = (t452*t465*t469*t471)/2.0;
        double t827 = (t449*t465*t469*t474)/2.0;
        double t828 = (t450*t466*t468*t474)/2.0;
        double t829 = (t451*t465*t469*t472)/2.0;
        double t830 = (t451*t465*t469*t473)/2.0;
        double t831 = (t452*t465*t469*t472)/2.0;
        double t832 = (t452*t465*t469*t473)/2.0;
        double t833 = (t451*t465*t469*t474)/2.0;
        double t834 = (t452*t465*t469*t474)/2.0;
        double t835 = (t399*t466*t468*t477)/2.0;
        double t836 = (t400*t466*t468*t477)/2.0;
        double t837 = (t401*t466*t468*t477)/2.0;
        double t838 = (t402*t466*t468*t477)/2.0;
        double t839 = (t403*t466*t468*t477)/2.0;
        double t840 = (t404*t466*t468*t477)/2.0;
        double t841 = (t405*t466*t468*t477)/2.0;
        double t842 = (t406*t466*t468*t477)/2.0;
        double t843 = (t407*t465*t469*t477)/2.0;
        double t844 = (t408*t465*t469*t477)/2.0;
        double t845 = (t409*t466*t468*t477)/2.0;
        double t846 = (t410*t466*t468*t477)/2.0;
        double t848 = (t411*t465*t469*t477)/2.0;
        double t849 = (t412*t465*t469*t477)/2.0;
        double t850 = (t413*t466*t468*t477)/2.0;
        double t851 = (t414*t466*t468*t477)/2.0;
        double t852 = (t415*t465*t469*t477)/2.0;
        double t853 = (t416*t465*t469*t477)/2.0;
        double t855 = (t417*t465*t469*t477)/2.0;
        double t856 = (t418*t465*t469*t477)/2.0;
        double t857 = (t419*t465*t469*t477)/2.0;
        double t858 = (t420*t465*t469*t477)/2.0;
        double t860 = (t421*t465*t469*t477)/2.0;
        double t861 = (t422*t465*t469*t477)/2.0;
        double t871 = (t434*t466*t468*t475)/2.0;
        double t872 = (t435*t466*t468*t475)/2.0;
        double t873 = (t436*t466*t468*t475)/2.0;
        double t874 = (t437*t466*t468*t475)/2.0;
        double t875 = (t434*t466*t468*t476)/2.0;
        double t876 = (t439*t465*t469*t475)/2.0;
        double t877 = (t440*t466*t468*t475)/2.0;
        double t878 = (t435*t466*t468*t476)/2.0;
        double t879 = (t441*t465*t469*t475)/2.0;
        double t880 = (t442*t466*t468*t475)/2.0;
        double t881 = (t436*t466*t468*t476)/2.0;
        double t882 = (t437*t466*t468*t476)/2.0;
        double t883 = (t439*t465*t469*t476)/2.0;
        double t884 = (t440*t466*t468*t476)/2.0;
        double t885 = (t443*t465*t469*t475)/2.0;
        double t886 = (t441*t465*t469*t476)/2.0;
        double t887 = (t442*t466*t468*t476)/2.0;
        double t888 = (t444*t465*t469*t475)/2.0;
        double t889 = (t445*t465*t469*t475)/2.0;
        double t890 = (t446*t465*t469*t475)/2.0;
        double t891 = (t443*t465*t469*t476)/2.0;
        double t892 = (t444*t465*t469*t476)/2.0;
        double t893 = (t445*t465*t469*t476)/2.0;
        double t894 = (t446*t465*t469*t476)/2.0;
        double t895 = (t447*t466*t468*t475)/2.0;
        double t897 = (t447*t466*t468*t476)/2.0;
        double t898 = (t449*t465*t469*t475)/2.0;
        double t899 = (t450*t466*t468*t475)/2.0;
        double t901 = (t448*t466*t468*t476)/2.0;
        double t903 = (t449*t465*t469*t476)/2.0;
        double t906 = (t452*t465*t469*t475)/2.0;
        double t908 = (t451*t465*t469*t476)/2.0;
        double t917 = t434*t462*t463*t478;
        double t918 = t435*t462*t463*t478;
        double t919 = t436*t462*t463*t478;
        double t920 = t437*t462*t463*t478;
        double t921 = t439*t461*t464*t478;
        double t922 = t440*t462*t463*t478;
        double t923 = t441*t461*t464*t478;
        double t924 = t442*t462*t463*t478;
        double t925 = t443*t461*t464*t478;
        double t926 = t444*t461*t464*t478;
        double t927 = t445*t461*t464*t478;
        double t928 = t446*t461*t464*t478;
        double t929 = t447*t462*t463*t478;
        double t930 = t448*t462*t463*t478;
        double t931 = t449*t461*t464*t478;
        double t932 = t450*t462*t463*t478;
        double t933 = t451*t461*t464*t478;
        double t934 = t452*t461*t464*t478;
        double t941 = (t434*t466*t468*t477)/2.0;
        double t942 = (t435*t466*t468*t477)/2.0;
        double t943 = (t436*t466*t468*t477)/2.0;
        double t944 = (t437*t466*t468*t477)/2.0;
        double t945 = (t439*t465*t469*t477)/2.0;
        double t946 = (t440*t466*t468*t477)/2.0;
        double t947 = (t441*t465*t469*t477)/2.0;
        double t948 = (t442*t466*t468*t477)/2.0;
        double t949 = (t443*t465*t469*t477)/2.0;
        double t950 = (t444*t465*t469*t477)/2.0;
        double t951 = (t445*t465*t469*t477)/2.0;
        double t952 = (t446*t465*t469*t477)/2.0;
        double t954 = (t447*t466*t468*t477)/2.0;
        double t956 = (t448*t466*t468*t477)/2.0;
        double t958 = (t449*t465*t469*t477)/2.0;
        double t959 = (t450*t466*t468*t477)/2.0;
        double t961 = (t451*t465*t469*t477)/2.0;
        double t962 = (t452*t465*t469*t477)/2.0;
        double t969 = -t965;
        double t970 = -t966;
        double t971 = -t967;
        double t972 = -t968;
        double t975 = -t973;
        double t976 = -t974;
        double t977 = t434*t435*t467*t468*t477*(3.0/4.0);
        double t978 = t434*t436*t467*t468*t477*(3.0/4.0);
        double t979 = t434*t437*t467*t468*t477*(3.0/4.0);
        double t980 = (t434*t439*t466*t469*t477)/4.0;
        double t981 = t435*t436*t467*t468*t477*(3.0/4.0);
        double t982 = t434*t440*t467*t468*t477*(3.0/4.0);
        double t983 = (t434*t441*t466*t469*t477)/4.0;
        double t984 = t435*t437*t467*t468*t477*(3.0/4.0);
        double t985 = (t435*t439*t466*t469*t477)/4.0;
        double t986 = t434*t442*t467*t468*t477*(3.0/4.0);
        double t987 = t435*t440*t467*t468*t477*(3.0/4.0);
        double t988 = t436*t437*t467*t468*t477*(3.0/4.0);
        double t989 = (t436*t439*t466*t469*t477)/4.0;
        double t990 = (t435*t441*t466*t469*t477)/4.0;
        double t991 = t436*t440*t467*t468*t477*(3.0/4.0);
        double t992 = t435*t442*t467*t468*t477*(3.0/4.0);
        double t993 = (t436*t441*t466*t469*t477)/4.0;
        double t994 = (t437*t439*t466*t469*t477)/4.0;
        double t995 = (t434*t443*t466*t469*t477)/4.0;
        double t996 = t436*t442*t467*t468*t477*(3.0/4.0);
        double t997 = t437*t440*t467*t468*t477*(3.0/4.0);
        double t998 = (t439*t440*t466*t469*t477)/4.0;
        double t999 = (t437*t441*t466*t469*t477)/4.0;
        double t1000 = (t434*t444*t466*t469*t477)/4.0;
        double t1001 = (t435*t443*t466*t469*t477)/4.0;
        double t1002 = t437*t442*t467*t468*t477*(3.0/4.0);
        double t1003 = (t439*t442*t466*t469*t477)/4.0;
        double t1004 = (t440*t441*t466*t469*t477)/4.0;
        double t1005 = (t434*t445*t466*t469*t477)/4.0;
        double t1006 = t439*t441*t465*t470*t477*(3.0/4.0);
        double t1007 = t440*t442*t467*t468*t477*(3.0/4.0);
        double t1008 = (t435*t444*t466*t469*t477)/4.0;
        double t1009 = (t441*t442*t466*t469*t477)/4.0;
        double t1010 = (t434*t446*t466*t469*t477)/4.0;
        double t1011 = (t435*t445*t466*t469*t477)/4.0;
        double t1012 = (t436*t444*t466*t469*t477)/4.0;
        double t1013 = (t437*t443*t466*t469*t477)/4.0;
        double t1014 = (t436*t445*t466*t469*t477)/4.0;
        double t1015 = (t440*t443*t466*t469*t477)/4.0;
        double t1016 = (t435*t446*t466*t469*t477)/4.0;
        double t1017 = t439*t443*t465*t470*t477*(3.0/4.0);
        double t1018 = (t436*t446*t466*t469*t477)/4.0;
        double t1019 = (t437*t445*t466*t469*t477)/4.0;
        double t1020 = (t440*t444*t466*t469*t477)/4.0;
        double t1021 = (t442*t443*t466*t469*t477)/4.0;
        double t1022 = t439*t444*t465*t470*t477*(3.0/4.0);
        double t1023 = t441*t443*t465*t470*t477*(3.0/4.0);
        double t1024 = (t437*t446*t466*t469*t477)/4.0;
        double t1025 = t439*t445*t465*t470*t477*(3.0/4.0);
        double t1026 = (t442*t444*t466*t469*t477)/4.0;
        double t1027 = (t440*t446*t466*t469*t477)/4.0;
        double t1028 = t441*t444*t465*t470*t477*(3.0/4.0);
        double t1029 = (t442*t445*t466*t469*t477)/4.0;
        double t1030 = t439*t446*t465*t470*t477*(3.0/4.0);
        double t1031 = t441*t445*t465*t470*t477*(3.0/4.0);
        double t1032 = t441*t446*t465*t470*t477*(3.0/4.0);
        double t1033 = t443*t444*t465*t470*t477*(3.0/4.0);
        double t1034 = t443*t445*t465*t470*t477*(3.0/4.0);
        double t1035 = t443*t446*t465*t470*t477*(3.0/4.0);
        double t1036 = t444*t445*t465*t470*t477*(3.0/4.0);
        double t1037 = t444*t446*t465*t470*t477*(3.0/4.0);
        double t1038 = t445*t446*t465*t470*t477*(3.0/4.0);
        double t1039 = t434*t447*t467*t468*t477*(3.0/4.0);
        double t1042 = t435*t447*t467*t468*t477*(3.0/4.0);
        double t1043 = t434*t448*t467*t468*t477*(3.0/4.0);
        double t1044 = t436*t447*t467*t468*t477*(3.0/4.0);
        double t1048 = (t434*t449*t466*t469*t477)/4.0;
        double t1049 = t437*t447*t467*t468*t477*(3.0/4.0);
        double t1050 = (t439*t447*t466*t469*t477)/4.0;
        double t1051 = t435*t448*t467*t468*t477*(3.0/4.0);
        double t1052 = t434*t450*t467*t468*t477*(3.0/4.0);
        double t1054 = t440*t447*t467*t468*t477*(3.0/4.0);
        double t1057 = t436*t448*t467*t468*t477*(3.0/4.0);
        double t1059 = (t441*t447*t466*t469*t477)/4.0;
        double t1061 = (t435*t449*t466*t469*t477)/4.0;
        double t1064 = t442*t447*t467*t468*t477*(3.0/4.0);
        double t1065 = t435*t450*t467*t468*t477*(3.0/4.0);
        double t1067 = (t436*t449*t466*t469*t477)/4.0;
        double t1068 = t437*t448*t467*t468*t477*(3.0/4.0);
        double t1069 = (t439*t448*t466*t469*t477)/4.0;
        double t1071 = t436*t450*t467*t468*t477*(3.0/4.0);
        double t1073 = t440*t448*t467*t468*t477*(3.0/4.0);
        double t1077 = (t441*t448*t466*t469*t477)/4.0;
        double t1079 = (t437*t449*t466*t469*t477)/4.0;
        double t1081 = (t434*t451*t466*t469*t477)/4.0;
        double t1082 = (t443*t447*t466*t469*t477)/4.0;
        double t1083 = t442*t448*t467*t468*t477*(3.0/4.0);
        double t1084 = t437*t450*t467*t468*t477*(3.0/4.0);
        double t1086 = (t439*t450*t466*t469*t477)/4.0;
        double t1087 = (t440*t449*t466*t469*t477)/4.0;
        double t1091 = t439*t449*t465*t470*t477*(3.0/4.0);
        double t1093 = t440*t450*t467*t468*t477*(3.0/4.0);
        double t1096 = (t444*t447*t466*t469*t477)/4.0;
        double t1097 = (t435*t451*t466*t469*t477)/4.0;
        double t1100 = (t442*t449*t466*t469*t477)/4.0;
        double t1101 = (t441*t450*t466*t469*t477)/4.0;
        double t1102 = (t434*t452*t466*t469*t477)/4.0;
        double t1103 = (t445*t447*t466*t469*t477)/4.0;
        double t1105 = (t436*t451*t466*t469*t477)/4.0;
        double t1106 = (t443*t448*t466*t469*t477)/4.0;
        double t1107 = t441*t449*t465*t470*t477*(3.0/4.0);
        double t1108 = t442*t450*t467*t468*t477*(3.0/4.0);
        double t1114 = (t446*t447*t466*t469*t477)/4.0;
        double t1115 = (t435*t452*t466*t469*t477)/4.0;
        double t1117 = (t444*t448*t466*t469*t477)/4.0;
        double t1118 = (t437*t451*t466*t469*t477)/4.0;
        double t1121 = (t436*t452*t466*t469*t477)/4.0;
        double t1122 = (t445*t448*t466*t469*t477)/4.0;
        double t1124 = (t440*t451*t466*t469*t477)/4.0;
        double t1125 = (t443*t450*t466*t469*t477)/4.0;
        double t1128 = t439*t451*t465*t470*t477*(3.0/4.0);
        double t1130 = t443*t449*t465*t470*t477*(3.0/4.0);
        double t1132 = (t446*t448*t466*t469*t477)/4.0;
        double t1133 = (t437*t452*t466*t469*t477)/4.0;
        double t1135 = (t444*t450*t466*t469*t477)/4.0;
        double t1137 = (t442*t451*t466*t469*t477)/4.0;
        double t1140 = (t440*t452*t466*t469*t477)/4.0;
        double t1141 = t444*t449*t465*t470*t477*(3.0/4.0);
        double t1142 = (t445*t450*t466*t469*t477)/4.0;
        double t1143 = t441*t451*t465*t470*t477*(3.0/4.0);
        double t1145 = t439*t452*t465*t470*t477*(3.0/4.0);
        double t1147 = t445*t449*t465*t470*t477*(3.0/4.0);
        double t1151 = (t446*t450*t466*t469*t477)/4.0;
        double t1153 = (t442*t452*t466*t469*t477)/4.0;
        double t1154 = t446*t449*t465*t470*t477*(3.0/4.0);
        double t1155 = t441*t452*t465*t470*t477*(3.0/4.0);
        double t1157 = t443*t451*t465*t470*t477*(3.0/4.0);
        double t1160 = t444*t451*t465*t470*t477*(3.0/4.0);
        double t1161 = t443*t452*t465*t470*t477*(3.0/4.0);
        double t1162 = t445*t451*t465*t470*t477*(3.0/4.0);
        double t1165 = t446*t451*t465*t470*t477*(3.0/4.0);
        double t1166 = t444*t452*t465*t470*t477*(3.0/4.0);
        double t1168 = t445*t452*t465*t470*t477*(3.0/4.0);
        double t1170 = t446*t452*t465*t470*t477*(3.0/4.0);
        double t1175 = t447*t448*t467*t468*t477*(3.0/4.0);
        double t1182 = (t447*t449*t466*t469*t477)/4.0;
        double t1184 = t447*t450*t467*t468*t477*(3.0/4.0);
        double t1193 = (t448*t449*t466*t469*t477)/4.0;
        double t1194 = t448*t450*t467*t468*t477*(3.0/4.0);
        double t1201 = (t447*t451*t466*t469*t477)/4.0;
        double t1204 = (t449*t450*t466*t469*t477)/4.0;
        double t1214 = (t447*t452*t466*t469*t477)/4.0;
        double t1221 = (t448*t452*t466*t469*t477)/4.0;
        double t1224 = (t450*t451*t466*t469*t477)/4.0;
        double t1225 = t449*t451*t465*t470*t477*(3.0/4.0);
        double t1232 = t449*t452*t465*t470*t477*(3.0/4.0);
        double t1238 = t451*t452*t465*t470*t477*(3.0/4.0);
        double t641 = -t595;
        double t645 = -t599;
        double t654 = -t615;
        double t663 = -t626;
        double t703 = -t693;
        double t704 = -t698;
        double t710 = t707+1.0;
        double t711 = 1.0/t709;
        double t712 = angleRest+t2+t708;
        double t733 = -t719;
        double t734 = -t720;
        double t765 = -t753;
        double t766 = -t755;
        double t767 = -t757;
        double t769 = -t761;
        double t847 = -t817;
        double t854 = -t821;
        double t859 = -t825;
        double t862 = -t828;
        double t863 = -t829;
        double t864 = -t831;
        double t865 = -t833;
        double t866 = -t834;
        double t867 = -t845;
        double t868 = -t846;
        double t869 = -t857;
        double t870 = -t858;
        double t896 = -t874;
        double t900 = -t880;
        double t902 = -t882;
        double t904 = -t887;
        double t905 = -t888;
        double t907 = -t890;
        double t909 = -t892;
        double t910 = -t894;
        double t935 = -t917;
        double t936 = -t918;
        double t937 = -t921;
        double t938 = -t923;
        double t939 = -t929;
        double t940 = -t931;
        double t953 = -t941;
        double t955 = -t942;
        double t957 = -t945;
        double t960 = -t947;
        double t963 = -t954;
        double t964 = -t958;
        double t1040 = -t977;
        double t1041 = -t978;
        double t1045 = -t979;
        double t1046 = -t981;
        double t1047 = -t982;
        double t1053 = -t983;
        double t1055 = -t984;
        double t1056 = -t985;
        double t1058 = -t986;
        double t1060 = -t987;
        double t1062 = -t988;
        double t1063 = -t989;
        double t1066 = -t991;
        double t1070 = -t992;
        double t1072 = -t993;
        double t1074 = -t994;
        double t1075 = -t995;
        double t1076 = -t996;
        double t1078 = -t997;
        double t1080 = -t998;
        double t1085 = -t999;
        double t1088 = -t1000;
        double t1089 = -t1001;
        double t1090 = -t1002;
        double t1092 = -t1003;
        double t1094 = -t1004;
        double t1095 = -t1005;
        double t1098 = -t1006;
        double t1099 = -t1007;
        double t1104 = -t1008;
        double t1109 = -t1009;
        double t1110 = -t1010;
        double t1111 = -t1011;
        double t1112 = -t1012;
        double t1113 = -t1013;
        double t1116 = -t1014;
        double t1119 = -t1015;
        double t1120 = -t1016;
        double t1123 = -t1017;
        double t1126 = -t1018;
        double t1127 = -t1019;
        double t1129 = -t1020;
        double t1131 = -t1021;
        double t1134 = -t1022;
        double t1136 = -t1023;
        double t1138 = -t1024;
        double t1139 = -t1025;
        double t1144 = -t1026;
        double t1146 = -t1027;
        double t1148 = -t1028;
        double t1149 = -t1029;
        double t1150 = -t1030;
        double t1152 = -t1031;
        double t1156 = -t1032;
        double t1158 = -t1033;
        double t1159 = -t1034;
        double t1163 = -t1035;
        double t1164 = -t1036;
        double t1167 = -t1037;
        double t1169 = -t1038;
        double t1171 = -t1039;
        double t1172 = -t1042;
        double t1173 = -t1043;
        double t1174 = -t1044;
        double t1176 = -t1048;
        double t1177 = -t1049;
        double t1178 = -t1050;
        double t1179 = -t1051;
        double t1180 = -t1052;
        double t1181 = -t1054;
        double t1183 = -t1057;
        double t1185 = -t1059;
        double t1186 = -t1061;
        double t1187 = -t1064;
        double t1188 = -t1065;
        double t1189 = -t1067;
        double t1190 = -t1069;
        double t1191 = -t1071;
        double t1192 = -t1073;
        double t1195 = -t1077;
        double t1196 = -t1079;
        double t1197 = -t1081;
        double t1198 = -t1082;
        double t1199 = -t1086;
        double t1200 = -t1087;
        double t1202 = -t1091;
        double t1203 = -t1093;
        double t1205 = -t1096;
        double t1206 = -t1097;
        double t1207 = -t1100;
        double t1208 = -t1101;
        double t1209 = -t1102;
        double t1210 = -t1103;
        double t1211 = -t1105;
        double t1212 = -t1106;
        double t1213 = -t1107;
        double t1215 = -t1114;
        double t1216 = -t1115;
        double t1217 = -t1121;
        double t1218 = -t1122;
        double t1219 = -t1124;
        double t1220 = -t1125;
        double t1222 = -t1128;
        double t1223 = -t1130;
        double t1226 = -t1140;
        double t1227 = -t1141;
        double t1228 = -t1142;
        double t1229 = -t1143;
        double t1230 = -t1145;
        double t1231 = -t1147;
        double t1233 = -t1154;
        double t1234 = -t1155;
        double t1235 = -t1157;
        double t1236 = -t1161;
        double t1237 = -t1162;
        double t1239 = -t1168;
        double t1240 = -t1175;
        double t1241 = -t1184;
        double t1242 = -t1193;
        double t1243 = -t1194;
        double t1244 = -t1201;
        double t1245 = -t1204;
        double t1246 = -t1214;
        double t1247 = -t1221;
        double t1248 = -t1224;
        double t1249 = -t1225;
        double t1250 = -t1232;
        double t1251 = -t1238;
        double t1264 = t589+t943+t949;
        double t1265 = t590+t944+t950;
        double t1266 = t591+t946+t951;
        double t1267 = t592+t948+t952;
        double t1268 = t639+t956+t961;
        double t1269 = t640+t959+t962;
        double t1270 = t919+t925+t969;
        double t1271 = t920+t926+t970;
        double t1272 = t922+t927+t971;
        double t1273 = t924+t928+t972;
        double t1274 = t930+t933+t975;
        double t1275 = t932+t934+t976;
        double t713 = 1.0/sqrt(t710);
        double t1252 = t567+t957;
        double t1253 = t569+t953;
        double t1254 = t568+t960;
        double t1255 = t570+t955;
        double t1256 = t571+t964;
        double t1257 = t572+t963;
        double t1258 = t911+t937;
        double t1259 = t913+t935;
        double t1260 = t912+t938;
        double t1261 = t914+t936;
        double t1262 = t915+t940;
        double t1263 = t916+t939;
        double t1276 = t483+t596+t622+t1056;
        double t1277 = t483+t597+t620+t1053;
        double t1278 = t481+t643+t685+t1185;
        double t1279 = t481+t660+t670+t1186;
        double t1280 = t486+t641+t654+t980;
        double t1281 = t484+t645+t663+t990;
        double t1282 = t482+t642+t682+t1178;
        double t1283 = t482+t657+t669+t1176;
        double t1284 = t485+t703+t704+t1182;
        double t1285 = t608+t609+t718+t1040;
        double t1286 = t604+t606+t717+t1098;
        double t1287 = t649+t675+t716+t1171;
        double t1288 = t647+t673+t715+t1202;
        double t1289 = t652+t678+t734+t1172;
        double t1290 = t650+t676+t733+t1213;
        double t1393 = t519+t610+t630+t739+t771+t1041+t1075;
        double t1394 = t512+t598+t614+t744+t777+t1063+t1123;
        double t1395 = t509+t617+t635+t735+t776+t1055+t1104;
        double t1396 = t505+t603+t625+t737+t790+t1085+t1148;
        double t1397 = t524+t616+t634+t745+t775+t1047+t1095;
        double t1398 = t520+t602+t624+t748+t789+t1080+t1139;
        double t1399 = t517+t627+t638+t738+t788+t1070+t1120;
        double t1400 = t510+t611+t631+t742+t802+t1109+t1156;
        double t1401 = t516+t613+t632+t766+t773+t1045+t1088;
        double t1402 = t508+t600+t618+t769+t785+t1074+t1134;
        double t1403 = t540+t612+t633+t756+t772+t1046+t1089;
        double t1404 = t538+t601+t619+t762+t781+t1072+t1136;
        double t1405 = t511+t653+t665+t765+t871+t1173+t1197;
        double t1406 = t506+t644+t656+t767+t876+t1190+t1222;
        double t1407 = t536+t680+t690+t759+t813+t1177+t1205;
        double t1408 = t535+t672+t684+t763+t820+t1196+t1227;
        double t1409 = t539+t679+t689+t754+t811+t1174+t1198;
        double t1410 = t537+t671+t681+t758+t815+t1189+t1223;
        double t1411 = t534+t655+t666+t768+t872+t1179+t1206;
        double t1412 = t532+t646+t659+t770+t879+t1195+t1229;
        double t1413 = t514+t696+t701+t736+t895+t1240+t1244;
        double t1414 = t507+t694+t697+t740+t898+t1242+t1249;
        double t1415 = t522+t699+t702+t741+t897+t1241+t1246;
        double t1416 = t515+t695+t700+t746+t903+t1245+t1250;
        double t1417 = t559+t623+t637+t780+t840+t1060+t1111;
        double t1418 = t560+t621+t636+t784+t839+t1058+t1110;
        double t1419 = t555+t607+t629+t793+t853+t1094+t1152;
        double t1420 = t556+t605+t628+t798+t852+t1092+t1150;
        double t1421 = t552+t686+t692+t819+t867+t1187+t1215;
        double t1422 = t548+t677+t688+t827+t869+t1207+t1233;
        double t1423 = t557+t683+t691+t814+t836+t1181+t1210;
        double t1424 = t553+t674+t687+t822+t844+t1200+t1231;
        double t1425 = t551+t661+t668+t868+t878+t1188+t1216;
        double t1426 = t547+t651+t664+t870+t886+t1208+t1234;
        double t1427 = t558+t658+t667+t835+t875+t1180+t1209;
        double t1428 = t554+t648+t662+t843+t883+t1199+t1230;
        double t1429 = kd*t711*t1264*t1265*2.0;
        double t1430 = kd*t711*t1264*t1266*2.0;
        double t1431 = kd*t711*t1264*t1267*2.0;
        double t1432 = kd*t711*t1265*t1266*2.0;
        double t1433 = kd*t711*t1265*t1267*2.0;
        double t1434 = kd*t711*t1266*t1267*2.0;
        double t1437 = kd*t711*t1264*t1268*2.0;
        double t1438 = kd*t711*t1265*t1268*2.0;
        double t1439 = kd*t711*t1264*t1269*2.0;
        double t1440 = kd*t711*t1266*t1268*2.0;
        double t1441 = kd*t711*t1267*t1268*2.0;
        double t1442 = kd*t711*t1265*t1269*2.0;
        double t1443 = kd*t711*t1266*t1269*2.0;
        double t1444 = kd*t711*t1267*t1269*2.0;
        double t1449 = kd*t711*t1268*t1269*2.0;
        double t1504 = t523+t722+t726+t774+t779+t795+t800+t1062+t1112+t1113+t1158;
        double t1505 = t527+t727+t731+t794+t799+t808+t810+t1099+t1146+t1149+t1169;
        double t1506 = t518+t721+t724+t812+t824+t873+t885+t1183+t1211+t1212+t1235;
        double t1507 = t525+t723+t728+t847+t863+t896+t905+t1068+t1117+t1118+t1160;
        double t1508 = t526+t725+t730+t823+t832+t884+t893+t1203+t1226+t1228+t1239;
        double t1509 = t528+t729+t732+t862+t866+t904+t910+t1108+t1151+t1153+t1170;
        double t1510 = t566+t749+t752+t778+t783+t797+t803+t1066+t1116+t1119+t1159;
        double t1511 = t564+t743+t750+t791+t796+t806+t809+t1090+t1138+t1144+t1167;
        double t1512 = t565+t747+t751+t899+t901+t906+t908+t1243+t1247+t1248+t1251;
        double t1513 = t581+t786+t787+t804+t805+t842+t856+t1078+t1127+t1129+t1164;
        double t1514 = t582+t782+t792+t801+t807+t841+t855+t1076+t1126+t1131+t1163;
        double t1515 = t579+t818+t830+t838+t849+t877+t889+t1192+t1218+t1219+t1237;
        double t1516 = t580+t816+t826+t837+t848+t881+t891+t1191+t1217+t1220+t1236;
        double t1517 = t583+t851+t854+t861+t864+t902+t909+t1084+t1133+t1135+t1166;
        double t1518 = t584+t850+t859+t860+t865+t900+t907+t1083+t1132+t1137+t1165;
        double t714 = t713*t713*t713;
        double t1291 = kd*t711*t1252*t1253*2.0;
        double t1292 = kd*t711*t1252*t1254*2.0;
        double t1293 = kd*t711*t1252*t1255*2.0;
        double t1294 = kd*t711*t1253*t1254*2.0;
        double t1295 = kd*t711*t1253*t1255*2.0;
        double t1296 = kd*t711*t1254*t1255*2.0;
        double t1299 = kd*t711*t1252*t1256*2.0;
        double t1300 = kd*t711*t1252*t1257*2.0;
        double t1301 = kd*t711*t1253*t1256*2.0;
        double t1302 = kd*t711*t1253*t1257*2.0;
        double t1303 = kd*t711*t1254*t1256*2.0;
        double t1304 = kd*t711*t1255*t1256*2.0;
        double t1305 = kd*t711*t1254*t1257*2.0;
        double t1306 = kd*t711*t1255*t1257*2.0;
        double t1311 = kd*t711*t1256*t1257*2.0;
        double t1313 = kd*t712*t713*(t480-t596-t622+t985)*-2.0;
        double t1314 = kd*t712*t713*(t480-t597-t620+t983)*-2.0;
        double t1315 = kd*t712*t713*(t480-t596-t622+t985)*2.0;
        double t1316 = kd*t712*t713*(t480-t597-t620+t983)*2.0;
        double t1317 = kd*t712*t713*t1278*2.0;
        double t1318 = kd*t712*t713*t1279*2.0;
        double t1319 = kd*t712*t713*(t479-t642-t682+t1050)*-2.0;
        double t1320 = kd*t712*t713*(t479-t657-t669+t1048)*-2.0;
        double t1321 = kd*t712*t713*t1280*2.0;
        double t1322 = kd*t712*t713*t1281*2.0;
        double t1323 = kd*t712*t713*(t479-t642-t682+t1050)*2.0;
        double t1324 = kd*t712*t713*(t479-t657-t669+t1048)*2.0;
        double t1327 = kd*t712*t713*t1284*2.0;
        double t1329 = kd*t711*t1252*t1264*2.0;
        double t1330 = kd*t711*t1253*t1264*2.0;
        double t1331 = kd*t711*t1254*t1264*2.0;
        double t1332 = kd*t711*t1255*t1264*2.0;
        double t1333 = kd*t711*t1252*t1265*2.0;
        double t1334 = kd*t711*t1253*t1265*2.0;
        double t1335 = kd*t711*t1252*t1266*2.0;
        double t1336 = kd*t711*t1253*t1266*2.0;
        double t1337 = kd*t711*t1254*t1265*2.0;
        double t1338 = kd*t711*t1255*t1265*2.0;
        double t1339 = kd*t711*t1254*t1266*2.0;
        double t1340 = kd*t711*t1255*t1266*2.0;
        double t1341 = kd*t711*t1252*t1267*2.0;
        double t1342 = kd*t711*t1253*t1267*2.0;
        double t1343 = kd*t711*t1254*t1267*2.0;
        double t1344 = kd*t711*t1255*t1267*2.0;
        double t1353 = kd*t711*t1256*t1264*2.0;
        double t1354 = kd*t711*t1257*t1264*2.0;
        double t1355 = kd*t711*t1256*t1265*2.0;
        double t1356 = kd*t711*t1257*t1265*2.0;
        double t1357 = kd*t711*t1256*t1266*2.0;
        double t1358 = kd*t711*t1257*t1266*2.0;
        double t1359 = kd*t711*t1256*t1267*2.0;
        double t1360 = kd*t711*t1257*t1267*2.0;
        double t1365 = kd*t711*t1252*t1268*2.0;
        double t1366 = kd*t711*t1253*t1268*2.0;
        double t1367 = kd*t711*t1254*t1268*2.0;
        double t1368 = kd*t711*t1255*t1268*2.0;
        double t1369 = kd*t711*t1252*t1269*2.0;
        double t1370 = kd*t711*t1253*t1269*2.0;
        double t1371 = kd*t711*t1254*t1269*2.0;
        double t1372 = kd*t711*t1255*t1269*2.0;
        double t1377 = kd*t711*t1256*t1268*2.0;
        double t1378 = kd*t711*t1257*t1268*2.0;
        double t1379 = kd*t711*t1256*t1269*2.0;
        double t1380 = kd*t711*t1257*t1269*2.0;
        double t1383 = kd*t712*t713*t1285*2.0;
        double t1384 = kd*t712*t713*t1286*2.0;
        double t1387 = kd*t712*t713*t1287*2.0;
        double t1388 = kd*t712*t713*t1288*2.0;
        double t1391 = kd*t712*t713*t1289*2.0;
        double t1392 = kd*t712*t713*t1290*2.0;
        double t1435 = -t1431;
        double t1436 = -t1432;
        double t1445 = -t1438;
        double t1446 = -t1439;
        double t1447 = -t1440;
        double t1448 = -t1444;
        double t1450 = kd*t712*t713*t1393*2.0;
        double t1451 = kd*t712*t713*t1394*2.0;
        double t1452 = kd*t712*t713*t1395*2.0;
        double t1453 = kd*t712*t713*t1396*2.0;
        double t1454 = kd*t712*t713*t1397*2.0;
        double t1455 = kd*t712*t713*t1398*2.0;
        double t1456 = kd*t712*t713*t1399*2.0;
        double t1457 = kd*t712*t713*t1400*2.0;
        double t1462 = kd*t712*t713*t1401*2.0;
        double t1463 = kd*t712*t713*t1402*2.0;
        double t1464 = kd*t712*t713*t1403*2.0;
        double t1465 = kd*t712*t713*t1404*2.0;
        double t1466 = kd*t712*t713*t1405*2.0;
        double t1467 = kd*t712*t713*t1406*2.0;
        double t1468 = kd*t712*t713*t1407*2.0;
        double t1469 = kd*t712*t713*t1408*2.0;
        double t1470 = kd*t712*t713*t1409*2.0;
        double t1471 = kd*t712*t713*t1410*2.0;
        double t1472 = kd*t712*t713*t1411*2.0;
        double t1474 = kd*t712*t713*t1412*2.0;
        double t1478 = kd*t712*t713*t1413*2.0;
        double t1479 = kd*t712*t713*t1414*2.0;
        double t1480 = kd*t712*t713*t1415*2.0;
        double t1481 = kd*t712*t713*t1416*2.0;
        double t1484 = kd*t712*t713*t1417*2.0;
        double t1485 = kd*t712*t713*t1418*2.0;
        double t1486 = kd*t712*t713*t1419*2.0;
        double t1487 = kd*t712*t713*t1420*2.0;
        double t1492 = kd*t712*t713*t1421*2.0;
        double t1493 = kd*t712*t713*t1422*2.0;
        double t1494 = kd*t712*t713*t1423*2.0;
        double t1495 = kd*t712*t713*t1424*2.0;
        double t1496 = kd*t712*t713*t1425*2.0;
        double t1497 = kd*t712*t713*t1426*2.0;
        double t1499 = kd*t712*t713*t1427*2.0;
        double t1501 = kd*t712*t713*t1428*2.0;
        double t1519 = kd*t712*t713*t1504*2.0;
        double t1520 = kd*t712*t713*t1505*2.0;
        double t1523 = kd*t712*t713*t1506*2.0;
        double t1524 = kd*t712*t713*t1507*2.0;
        double t1525 = kd*t712*t713*t1508*2.0;
        double t1526 = kd*t712*t713*t1509*2.0;
        double t1531 = kd*t712*t713*t1510*2.0;
        double t1532 = kd*t712*t713*t1511*2.0;
        double t1535 = kd*t712*t713*t1512*2.0;
        double t1537 = kd*t712*t713*t1513*2.0;
        double t1538 = kd*t712*t713*t1514*2.0;
        double t1539 = kd*t712*t713*t1515*2.0;
        double t1540 = kd*t712*t713*t1516*2.0;
        double t1541 = kd*t712*t713*t1517*2.0;
        double t1542 = kd*t712*t713*t1518*2.0;
        double t1297 = -t1291;
        double t1298 = -t1296;
        double t1307 = -t1303;
        double t1308 = -t1304;
        double t1309 = -t1305;
        double t1310 = -t1306;
        double t1312 = -t1311;
        double t1325 = -t1321;
        double t1326 = -t1322;
        double t1328 = -t1327;
        double t1345 = -t1329;
        double t1346 = -t1330;
        double t1347 = -t1337;
        double t1348 = -t1338;
        double t1349 = -t1339;
        double t1350 = -t1340;
        double t1351 = -t1341;
        double t1352 = -t1342;
        double t1361 = -t1355;
        double t1362 = -t1356;
        double t1363 = -t1357;
        double t1364 = -t1358;
        double t1373 = -t1367;
        double t1374 = -t1368;
        double t1375 = -t1369;
        double t1376 = -t1370;
        double t1381 = -t1377;
        double t1382 = -t1378;
        double t1385 = -t1383;
        double t1386 = -t1384;
        double t1389 = -t1387;
        double t1390 = -t1388;
        double t1458 = -t1450;
        double t1459 = -t1451;
        double t1460 = -t1452;
        double t1461 = -t1453;
        double t1473 = -t1468;
        double t1475 = -t1469;
        double t1476 = -t1472;
        double t1477 = -t1474;
        double t1482 = -t1478;
        double t1483 = -t1479;
        double t1488 = -t1484;
        double t1489 = -t1485;
        double t1490 = -t1486;
        double t1491 = -t1487;
        double t1498 = -t1494;
        double t1500 = -t1495;
        double t1502 = -t1499;
        double t1503 = -t1501;
        double t1521 = -t1519;
        double t1522 = -t1520;
        double t1527 = -t1523;
        double t1528 = -t1524;
        double t1529 = -t1525;
        double t1530 = -t1526;
        double t1533 = -t1531;
        double t1534 = -t1532;
        double t1536 = -t1535;
        
          CBlock[0][0] = kd*t711*(t1266*t1266)*-2.0-kd*t712*t713*(t465*t468*(t189+t194)-(t466*t468*t477*(t51+t54))/2.0-(t465*t469*t477*(t55+t56))/2.0-t440*t466*t468*t473-t445*t465*t469*t473+(t440*t440)*t467*t468*t477*(3.0/4.0)+(t445*t445)*t465*t470*t477*(3.0/4.0)+(t440*t445*t466*t469*t477)/2.0)*2.0-kd*t712*t714*t1266*t1272;
          CBlock[1][0] = t1443+t1529+kd*t712*t714*t1269*t1272;
          CBlock[2][0] = t1434+t1522+kd*t712*t714*t1267*t1272;
          CBlock[3][0] = t1430+t1533+kd*t712*t714*t1264*t1272;
          CBlock[4][0] = t1447+t1539-kd*t712*t714*t1268*t1272;
          CBlock[5][0] = t1436+t1537-kd*t712*t714*t1265*t1272;
          CBlock[6][0] = t1336+t1454+kd*t712*t714*t1253*t1272;
          CBlock[7][0] = t1364+t1498-kd*t712*t714*t1257*t1272;
          CBlock[8][0] = t1350+t1488-kd*t712*t714*t1255*t1272;
          CBlock[9][0] = t1335+t1455+kd*t712*t714*t1252*t1272;
          CBlock[10][0] = t1363+t1500-kd*t712*t714*t1256*t1272;
          CBlock[11][0] = t1349+t1490-kd*t712*t714*t1254*t1272;
        
          CBlock[0][1] = t1443+t1529+kd*t712*t714*t1266*t1275;
          CBlock[1][1] = kd*t711*(t1269*t1269)*-2.0-kd*t712*t713*(t465*t468*(t180+t194)-(t466*t468*t477*(t48+t54))/2.0-(t465*t469*t477*(t52+t56))/2.0-t450*t466*t468*t476-t452*t465*t469*t476+(t450*t450)*t467*t468*t477*(3.0/4.0)+(t452*t452)*t465*t470*t477*(3.0/4.0)+(t450*t452*t466*t469*t477)/2.0)*2.0-kd*t712*t714*t1269*t1275;
          CBlock[2][1] = t1448+t1530-kd*t712*t714*t1267*t1275;
          CBlock[3][1] = t1446+t1540-kd*t712*t714*t1264*t1275;
          CBlock[4][1] = t1449+t1536+kd*t712*t714*t1268*t1275;
          CBlock[5][1] = t1442+t1541+kd*t712*t714*t1265*t1275;
          CBlock[6][1] = t1376+t1502-kd*t712*t714*t1253*t1275;
          CBlock[7][1] = t1380+t1480+kd*t712*t714*t1257*t1275;
          CBlock[8][1] = t1372+t1496+kd*t712*t714*t1255*t1275;
          CBlock[9][1] = t1375+t1503-kd*t712*t714*t1252*t1275;
          CBlock[10][1] = t1379+t1481+kd*t712*t714*t1256*t1275;
          CBlock[11][1] = t1371+t1497+kd*t712*t714*t1254*t1275;
        
          CBlock[0][2] = t1434+t1522+kd*t712*t714*t1266*t1273;
          CBlock[1][2] = t1448+t1530-kd*t712*t714*t1269*t1273;
          CBlock[2][2] = kd*t711*(t1267*t1267)*-2.0-kd*t712*t713*(t465*t468*(t180+t189)-(t466*t468*t477*(t48+t51))/2.0-(t465*t469*t477*(t52+t55))/2.0-t442*t466*t468*t474-t446*t465*t469*t474+(t442*t442)*t467*t468*t477*(3.0/4.0)+(t446*t446)*t465*t470*t477*(3.0/4.0)+(t442*t446*t466*t469*t477)/2.0)*2.0-kd*t712*t714*t1267*t1273;
          CBlock[3][2] = t1435+t1538-kd*t712*t714*t1264*t1273;
          CBlock[4][2] = t1441+t1542+kd*t712*t714*t1268*t1273;
          CBlock[5][2] = t1433+t1534+kd*t712*t714*t1265*t1273;
          CBlock[6][2] = t1352+t1489-kd*t712*t714*t1253*t1273;
          CBlock[7][2] = t1360+t1492+kd*t712*t714*t1257*t1273;
          CBlock[8][2] = t1344+t1456+kd*t712*t714*t1255*t1273;
          CBlock[9][2] = t1351+t1491-kd*t712*t714*t1252*t1273;
          CBlock[10][2] = t1359+t1493+kd*t712*t714*t1256*t1273;
          CBlock[11][2] = t1343+t1457+kd*t712*t714*t1254*t1273;
        
          CBlock[0][3] = t1430+t1533+kd*t712*t714*t1266*t1270;
          CBlock[1][3] = t1446+t1540-kd*t712*t714*t1269*t1270;
          CBlock[2][3] = t1435+t1538-kd*t712*t714*t1267*t1270;
          CBlock[3][3] = kd*t711*(t1264*t1264)*-2.0-kd*t712*t713*(t465*t468*(t169+t184)-(t466*t468*t477*(t46+t49))/2.0-(t465*t469*t477*(t50+t53))/2.0-t436*t466*t468*t471-t443*t465*t469*t471+(t436*t436)*t467*t468*t477*(3.0/4.0)+(t443*t443)*t465*t470*t477*(3.0/4.0)+(t436*t443*t466*t469*t477)/2.0)*2.0-kd*t712*t714*t1264*t1270;
          CBlock[4][3] = t1437+t1527+kd*t712*t714*t1268*t1270;
          CBlock[5][3] = t1429+t1521+kd*t712*t714*t1265*t1270;
          CBlock[6][3] = t1346+t1458-kd*t712*t714*t1253*t1270;
          CBlock[7][3] = t1354+t1470+kd*t712*t714*t1257*t1270;
          CBlock[8][3] = t1332+t1464+kd*t712*t714*t1255*t1270;
          CBlock[9][3] = t1345+t1459-kd*t712*t714*t1252*t1270;
          CBlock[10][3] = t1353+t1471+kd*t712*t714*t1256*t1270;
          CBlock[11][3] = t1331+t1465+kd*t712*t714*t1254*t1270;
        
          CBlock[0][4] = t1447+t1539-kd*t712*t714*t1266*t1274;
          CBlock[1][4] = t1449+t1536+kd*t712*t714*t1269*t1274;
          CBlock[2][4] = t1441+t1542+kd*t712*t714*t1267*t1274;
          CBlock[3][4] = t1437+t1527+kd*t712*t714*t1264*t1274;
          CBlock[4][4] = kd*t711*(t1268*t1268)*-2.0-kd*t712*t713*(t465*t468*(t141+t184)-(t466*t468*t477*(t44+t49))/2.0-(t465*t469*t477*(t47+t53))/2.0-t448*t466*t468*t475-t451*t465*t469*t475+(t448*t448)*t467*t468*t477*(3.0/4.0)+(t451*t451)*t465*t470*t477*(3.0/4.0)+(t448*t451*t466*t469*t477)/2.0)*2.0-kd*t712*t714*t1268*t1274;
          CBlock[5][4] = t1445+t1528-kd*t712*t714*t1265*t1274;
          CBlock[6][4] = t1366+t1466+kd*t712*t714*t1253*t1274;
          CBlock[7][4] = t1382+t1482-kd*t712*t714*t1257*t1274;
          CBlock[8][4] = t1374+t1476-kd*t712*t714*t1255*t1274;
          CBlock[9][4] = t1365+t1467+kd*t712*t714*t1252*t1274;
          CBlock[10][4] = t1381+t1483-kd*t712*t714*t1256*t1274;
          CBlock[11][4] = t1373+t1477-kd*t712*t714*t1254*t1274;
        
          CBlock[0][5] = t1436+t1537-kd*t712*t714*t1266*t1271;
          CBlock[1][5] = t1442+t1541+kd*t712*t714*t1269*t1271;
          CBlock[2][5] = t1433+t1534+kd*t712*t714*t1267*t1271;
          CBlock[3][5] = t1429+t1521+kd*t712*t714*t1264*t1271;
          CBlock[4][5] = t1445+t1528-kd*t712*t714*t1268*t1271;
          CBlock[5][5] = kd*t711*(t1265*t1265)*-2.0-kd*t712*t713*(t465*t468*(t141+t169)-(t466*t468*t477*(t44+t46))/2.0-(t465*t469*t477*(t47+t50))/2.0-t437*t466*t468*t472-t444*t465*t469*t472+(t437*t437)*t467*t468*t477*(3.0/4.0)+(t444*t444)*t465*t470*t477*(3.0/4.0)+(t437*t444*t466*t469*t477)/2.0)*2.0-kd*t712*t714*t1265*t1271;
          CBlock[6][5] = t1334+t1462+kd*t712*t714*t1253*t1271;
          CBlock[7][5] = t1362+t1473-kd*t712*t714*t1257*t1271;
          CBlock[8][5] = t1348+t1460-kd*t712*t714*t1255*t1271;
          CBlock[9][5] = t1333+t1463+kd*t712*t714*t1252*t1271;
          CBlock[10][5] = t1361+t1475-kd*t712*t714*t1256*t1271;
          CBlock[11][5] = t1347+t1461-kd*t712*t714*t1254*t1271;
        
          CBlock[0][6] = t1336+t1454+kd*t712*t714*t1259*t1266;
          CBlock[1][6] = t1376+t1502-kd*t712*t714*t1259*t1269;
          CBlock[2][6] = t1352+t1489-kd*t712*t714*t1259*t1267;
          CBlock[3][6] = t1346+t1458-kd*t712*t714*t1259*t1264;
          CBlock[4][6] = t1366+t1466+kd*t712*t714*t1259*t1268;
          CBlock[5][6] = t1334+t1462+kd*t712*t714*t1259*t1265;
          CBlock[6][6] = kd*t711*(t1253*t1253)*-2.0+kd*t712*t713*((t230*t466*t468*t477)/2.0+t431*t434*t466*t468-(t434*t434)*t467*t468*t477*(3.0/4.0))*2.0-kd*t712*t714*t1253*t1259;
          CBlock[7][6] = t1302+t1389+kd*t712*t714*t1257*t1259;
          CBlock[8][6] = t1295+t1385+kd*t712*t714*t1255*t1259;
          CBlock[9][6] = t1297+t1325-kd*t712*t714*t1252*t1259;
          CBlock[10][6] = t1301+t1324+kd*t712*t714*t1256*t1259;
          CBlock[11][6] = t1294+t1316+kd*t712*t714*t1254*t1259;
        
          CBlock[0][7] = t1364+t1498-kd*t712*t714*t1263*t1266;
          CBlock[1][7] = t1380+t1480+kd*t712*t714*t1263*t1269;
          CBlock[2][7] = t1360+t1492+kd*t712*t714*t1263*t1267;
          CBlock[3][7] = t1354+t1470+kd*t712*t714*t1263*t1264;
          CBlock[4][7] = t1382+t1482-kd*t712*t714*t1263*t1268;
          CBlock[5][7] = t1362+t1473-kd*t712*t714*t1263*t1265;
          CBlock[6][7] = t1302+t1389+kd*t712*t714*t1253*t1263;
          CBlock[7][7] = kd*t711*(t1257*t1257)*-2.0+kd*t712*t713*((t229*t466*t468*t477)/2.0+t438*t447*t466*t468-(t447*t447)*t467*t468*t477*(3.0/4.0))*2.0-kd*t712*t714*t1257*t1263;
          CBlock[8][7] = t1310+t1391-kd*t712*t714*t1255*t1263;
          CBlock[9][7] = t1300+t1323+kd*t712*t714*t1252*t1263;
          CBlock[10][7] = t1312+t1328-kd*t712*t714*t1256*t1263;
          CBlock[11][7] = t1309+t1317-kd*t712*t714*t1254*t1263;
        
          CBlock[0][8] = t1350+t1488-kd*t712*t714*t1261*t1266;
          CBlock[1][8] = t1372+t1496+kd*t712*t714*t1261*t1269;
          CBlock[2][8] = t1344+t1456+kd*t712*t714*t1261*t1267;
          CBlock[3][8] = t1332+t1464+kd*t712*t714*t1261*t1264;
          CBlock[4][8] = t1374+t1476-kd*t712*t714*t1261*t1268;
          CBlock[5][8] = t1348+t1460-kd*t712*t714*t1261*t1265;
          CBlock[6][8] = t1295+t1385+kd*t712*t714*t1253*t1261;
          CBlock[7][8] = t1310+t1391-kd*t712*t714*t1257*t1261;
          CBlock[8][8] = kd*t711*(t1255*t1255)*-2.0+kd*t712*t713*((t228*t466*t468*t477)/2.0+t432*t435*t466*t468-(t435*t435)*t467*t468*t477*(3.0/4.0))*2.0-kd*t712*t714*t1255*t1261;
          CBlock[9][8] = t1293+t1315+kd*t712*t714*t1252*t1261;
          CBlock[10][8] = t1308+t1318-kd*t712*t714*t1256*t1261;
          CBlock[11][8] = t1298+t1326-kd*t712*t714*t1254*t1261;
        
          CBlock[0][9] = t1335+t1455+kd*t712*t714*t1258*t1266;
          CBlock[1][9] = t1375+t1503-kd*t712*t714*t1258*t1269;
          CBlock[2][9] = t1351+t1491-kd*t712*t714*t1258*t1267;
          CBlock[3][9] = t1345+t1459-kd*t712*t714*t1258*t1264;
          CBlock[4][9] = t1365+t1467+kd*t712*t714*t1258*t1268;
          CBlock[5][9] = t1333+t1463+kd*t712*t714*t1258*t1265;
          CBlock[6][9] = t1297+t1325-kd*t712*t714*t1253*t1258;
          CBlock[7][9] = t1300+t1323+kd*t712*t714*t1257*t1258;
          CBlock[8][9] = t1293+t1315+kd*t712*t714*t1255*t1258;
          CBlock[9][9] = kd*t711*(t1252*t1252)*-2.0+kd*t712*t713*((t230*t465*t469*t477)/2.0+t429*t439*t465*t469-(t439*t439)*t465*t470*t477*(3.0/4.0))*2.0-kd*t712*t714*t1252*t1258;
          CBlock[10][9] = t1299+t1390+kd*t712*t714*t1256*t1258;
          CBlock[11][9] = t1292+t1386+kd*t712*t714*t1254*t1258;
        
          CBlock[0][10] = t1363+t1500-kd*t712*t714*t1262*t1266;
          CBlock[1][10] = t1379+t1481+kd*t712*t714*t1262*t1269;
          CBlock[2][10] = t1359+t1493+kd*t712*t714*t1262*t1267;
          CBlock[3][10] = t1353+t1471+kd*t712*t714*t1262*t1264;
          CBlock[4][10] = t1381+t1483-kd*t712*t714*t1262*t1268;
          CBlock[5][10] = t1361+t1475-kd*t712*t714*t1262*t1265;
          CBlock[6][10] = t1301+t1324+kd*t712*t714*t1253*t1262;
          CBlock[7][10] = t1312+t1328-kd*t712*t714*t1257*t1262;
          CBlock[8][10] = t1308+t1318-kd*t712*t714*t1255*t1262;
          CBlock[9][10] = t1299+t1390+kd*t712*t714*t1252*t1262;
          CBlock[10][10] = kd*t711*(t1256*t1256)*-2.0+kd*t712*t713*((t229*t465*t469*t477)/2.0+t433*t449*t465*t469-(t449*t449)*t465*t470*t477*(3.0/4.0))*2.0-kd*t712*t714*t1256*t1262;
          CBlock[11][10] = t1307+t1392-kd*t712*t714*t1254*t1262;
        
          CBlock[0][11] = t1349+t1490-kd*t712*t714*t1260*t1266;
          CBlock[1][11] = t1371+t1497+kd*t712*t714*t1260*t1269;
          CBlock[2][11] = t1343+t1457+kd*t712*t714*t1260*t1267;
          CBlock[3][11] = t1331+t1465+kd*t712*t714*t1260*t1264;
          CBlock[4][11] = t1373+t1477-kd*t712*t714*t1260*t1268;
          CBlock[5][11] = t1347+t1461-kd*t712*t714*t1260*t1265;
          CBlock[6][11] = t1294+t1316+kd*t712*t714*t1253*t1260;
          CBlock[7][11] = t1309+t1317-kd*t712*t714*t1257*t1260;
          CBlock[8][11] = t1298+t1326-kd*t712*t714*t1255*t1260;
          CBlock[9][11] = t1292+t1386+kd*t712*t714*t1252*t1260;
          CBlock[10][11] = t1307+t1392-kd*t712*t714*t1256*t1260;
          CBlock[11][11] = kd*t711*(t1254*t1254)*-2.0+kd*t712*t713*((t228*t465*t469*t477)/2.0+t430*t441*t465*t469-(t441*t441)*t465*t470*t477*(3.0/4.0))*2.0-kd*t712*t714*t1254*t1260;
          gradblock[0] = kd*t712*t713*t1266*2.0;
          gradblock[1] = kd*t712*t713*t1269*-2.0;
          gradblock[2] = kd*t712*t713*t1267*-2.0;
          gradblock[3] = kd*t712*t713*t1264*-2.0;
          gradblock[4] = kd*t712*t713*t1268*2.0;
          gradblock[5] = kd*t712*t713*t1265*2.0;
          gradblock[6] = kd*t712*t713*t1253*-2.0;
          gradblock[7] = kd*t712*t713*t1257*2.0;
          gradblock[8] = kd*t712*t713*t1255*2.0;
          gradblock[9] = kd*t712*t713*t1252*-2.0;
          gradblock[10] = kd*t712*t713*t1256*2.0;
          gradblock[11] = kd*t712*t713*t1254*2.0;
          angle[i] = -t708+3.141592653589793;
          psi[i] = kd*(t712*t712);


        //updating the global variables
        newGrad[vertIDS[0]*3] = gradblock[0];
        newGrad[vertIDS[0]*3+1] = gradblock[1];
        newGrad[vertIDS[0]*3+2] = gradblock[2];
        newGrad[vertIDS[1]*3] = gradblock[3];
        newGrad[vertIDS[1]*3+1] = gradblock[4];
        newGrad[vertIDS[1]*3+2] = gradblock[5];
        newGrad[vertIDS[2]*3] = gradblock[6];
        newGrad[vertIDS[2]*3+1] = gradblock[7];
        newGrad[vertIDS[2]*3+2] = gradblock[8];
        newGrad[vertIDS[3]*3] = gradblock[9];
        newGrad[vertIDS[3]*3+1] = gradblock[10];
        newGrad[vertIDS[3]*3+2] = gradblock[11];
        
        for(size_t x = 0; x < 4; ++x){//12x12 block in x
            int idx = vertIDS[x]*3;
            for(size_t axisx = 0; axisx < 3; ++axisx){
                int posx = idx+axisx;
                for(size_t y = 0; y < 4; ++y){//12x12 block in y
                    int idy = vertIDS[y]*3;
                    for(size_t axisy = 0; axisy < 3; ++axisy){
                        int posy = idy+axisy;
                        newC[counter] = CBlock[x+axisx][y+axisy];
                        ii[counter] = posx + 1;
                        jj[counter] = posy + 1;
                        counter++;
                    }
                }
            }
        }
        
        
    }
}
